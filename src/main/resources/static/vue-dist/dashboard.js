import{_ as F,r as re,o as W,c as m,a as b,b as e,d as P,w as C,v as R,e as X,F as E,f as B,t as c,u as $,g as Y,h as k,i as N,j as le,k as T,n as A,l as ie,m as K,p as de,q as Z,s as ce,x as H,y as ue,z as pe}from"./chunks/_plugin-vue_export-helper-B8S04SUJ.js";/* empty css                    */import{u as V,p as ee,a as te}from"./chunks/useWebSocket-DJvTFef5.js";const ve=["value"],me={class:"flex space-x-2 pt-2"},be=["disabled"],fe=["disabled"],ge={key:0,class:"mt-4 p-3 bg-red-50 border-2 border-red-300"},xe={class:"text-sm text-red-600"},ye={__name:"TestControlPanel",setup(j){const r=V(),u=re({testName:"",planId:"",runType:"TEST",maxUsers:100,rampUpSeconds:60,testDurationSeconds:300,scenario:"BASIC"});async function g(){try{r.setTestConfig(u);const l=await r.startTest();console.log("Test started:",l),u.testName=""}catch(l){console.error("Failed to start test:",l)}}async function v(){var l;if((l=r.currentTest)!=null&&l.id)try{await r.stopTest(r.currentTest.id),console.log("Test stopped")}catch(i){console.error("Failed to stop test:",i)}}return W(()=>{r.plans.length===0&&r.loadPlans()}),(l,i)=>(b(),m("div",null,[i[14]||(i[14]=e("h2",{class:"flat-header"},"Test Control",-1)),e("form",{onSubmit:Y(g,["prevent"]),class:"space-y-2"},[e("div",null,[i[6]||(i[6]=e("label",{class:"flat-label"}," Test Name ",-1)),C(e("input",{"onUpdate:modelValue":i[0]||(i[0]=o=>u.testName=o),type:"text",required:"",class:"flat-input",placeholder:"Enter test name"},null,512),[[R,u.testName]])]),e("div",null,[i[8]||(i[8]=e("label",{class:"flat-label"}," Test Plan ",-1)),C(e("select",{"onUpdate:modelValue":i[1]||(i[1]=o=>u.planId=o),required:"",class:"flat-input"},[i[7]||(i[7]=e("option",{value:"",disabled:""},"Select a plan",-1)),(b(!0),m(E,null,B($(r).plans||[],o=>(b(),m("option",{key:(o==null?void 0:o.id)||(o==null?void 0:o.planId),value:(o==null?void 0:o.id)||(o==null?void 0:o.planId)},c((o==null?void 0:o.name)||(o==null?void 0:o.planName)||"Unnamed Plan")+" (ID: "+c((o==null?void 0:o.id)||(o==null?void 0:o.planId))+") ",9,ve))),128))],512),[[X,u.planId]])]),e("div",null,[i[10]||(i[10]=e("label",{class:"flat-label"}," Run Type ",-1)),C(e("select",{"onUpdate:modelValue":i[2]||(i[2]=o=>u.runType=o),class:"flat-input"},[...i[9]||(i[9]=[e("option",{value:"TEST"},"Test",-1),e("option",{value:"REAL"},"Real",-1)])],512),[[X,u.runType]])]),e("div",null,[i[11]||(i[11]=e("label",{class:"flat-label"}," Max Users ",-1)),C(e("input",{"onUpdate:modelValue":i[3]||(i[3]=o=>u.maxUsers=o),type:"number",min:"1",max:"10000",required:"",class:"flat-input"},null,512),[[R,u.maxUsers,void 0,{number:!0}]])]),e("div",null,[i[12]||(i[12]=e("label",{class:"flat-label"}," Ramp Up Duration (seconds) ",-1)),C(e("input",{"onUpdate:modelValue":i[4]||(i[4]=o=>u.rampUpSeconds=o),type:"number",min:"1",required:"",class:"flat-input"},null,512),[[R,u.rampUpSeconds,void 0,{number:!0}]])]),e("div",null,[i[13]||(i[13]=e("label",{class:"flat-label"}," Test Duration (seconds) ",-1)),C(e("input",{"onUpdate:modelValue":i[5]||(i[5]=o=>u.testDurationSeconds=o),type:"number",min:"1",required:"",class:"flat-input"},null,512),[[R,u.testDurationSeconds,void 0,{number:!0}]])]),e("div",me,[e("button",{type:"submit",disabled:$(r).loading||$(r).isTestRunning,class:"flex-1 flat-btn flat-btn-primary disabled:opacity-50 disabled:cursor-not-allowed"},c($(r).loading?"Starting...":"Start Test"),9,be),$(r).isTestRunning?(b(),m("button",{key:0,type:"button",onClick:v,disabled:$(r).loading,class:"flex-1 flat-btn flat-btn-danger disabled:opacity-50 disabled:cursor-not-allowed"},c($(r).loading?"Stopping...":"Stop Test"),9,fe)):P("",!0)])],32),$(r).error?(b(),m("div",ge,[e("p",xe,c($(r).error),1)])):P("",!0)]))}},_e=F(ye,[["__scopeId","data-v-86005fbf"]]),he={class:"flat-header flex justify-between items-center"},$e=["disabled"],Se={class:"mb-2 space-y-1"},ke={class:"flex space-x-2"},we={key:0,class:"text-gray-500 text-center py-8"},Te={key:1,class:"overflow-hidden border border-gray-200 rounded"},Ie={class:"overflow-x-auto"},De={class:"min-w-full border border-gray-200 text-sm"},Ce={class:"bg-gray-50/70 border-b border-gray-200"},Ne={key:0,class:"ml-1"},Pe={key:0,class:"ml-1"},Me={key:0,class:"ml-1"},Ue={class:"bg-white"},Re=["onClick"],Ee={class:"px-3 py-2 whitespace-nowrap"},Ae={class:"text-base font-medium text-gray-900"},Fe={class:"text-sm text-gray-500"},Ve={class:"px-3 py-2 whitespace-nowrap"},je={class:"text-base text-gray-900"},Le={class:"text-sm text-gray-500"},ze={class:"px-3 py-2 whitespace-nowrap"},qe={class:"px-3 py-2 whitespace-nowrap"},He={class:"text-sm text-gray-600"},Be={class:"text-sm text-gray-600"},We={key:0,class:"text-sm text-gray-600"},Oe={class:"px-3 py-2 whitespace-nowrap text-base font-medium space-x-2"},Qe=["onClick"],Ge=["onClick"],Je={class:"bg-gray-50/50 px-3 py-2 flex items-center justify-between border-t border-gray-200 sm:px-4"},Ke={class:"flex-1 flex justify-between sm:hidden"},Xe=["disabled"],Ye=["disabled"],Ze={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},et={class:"text-sm text-gray-700"},tt={class:"font-medium"},st={class:"font-medium"},ot={class:"font-medium"},at={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},nt=["disabled"],rt=["onClick"],lt=["disabled"],it={key:0,class:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50"},dt={class:"bg-white border border-gray-300 p-6 w-full max-w-md"},ct={class:"mb-4"},ut={class:"bg-gray-50 p-3 border border-gray-200"},pt={class:"text-sm font-medium"},vt={class:"text-xs text-gray-500"},mt={class:"flex justify-end space-x-3"},bt=["disabled"],ft={key:0},gt={key:1},xt={__name:"TestHistory",setup(j){const r=V(),u=k(!1),g=k(""),v=k(""),l=k("startTime"),i=k("desc"),o=k(1),I=k(10),S=k(!1),x=k(null),w=k(!1),_=N(()=>{let n=[...r.testHistory];if(g.value){const s=g.value.toLowerCase();n=n.filter(y=>y.testName&&y.testName.toLowerCase().includes(s)||y.testId&&y.testId.toString().includes(s))}return v.value&&(n=n.filter(s=>s.status===v.value)),n.sort((s,y)=>{let f=s[l.value],p=y[l.value];return l.value==="startTime"&&(f=new Date(f),p=new Date(p)),i.value==="asc"?f>p?1:-1:f<p?1:-1}),n}),D=N(()=>Math.ceil(_.value.length/I.value)),O=N(()=>{const n=(o.value-1)*I.value,s=n+I.value;return _.value.slice(n,s)}),Q=N(()=>{const n=[],s=D.value,y=o.value;if(s<=7)for(let f=1;f<=s;f++)n.push(f);else if(y<=4){for(let f=1;f<=5;f++)n.push(f);n.push("..."),n.push(s)}else if(y>=s-3){n.push(1),n.push("...");for(let f=s-4;f<=s;f++)n.push(f)}else{n.push(1),n.push("...");for(let f=y-1;f<=y+1;f++)n.push(f);n.push("..."),n.push(s)}return n.filter(f=>f!=="..."||n.length>1)});W(()=>{U()});async function U(){u.value=!0;try{await r.loadTestHistory()}catch(n){console.error("Failed to refresh history:",n)}finally{u.value=!1}}function t(n){l.value===n?i.value=i.value==="asc"?"desc":"asc":(l.value=n,i.value="desc"),o.value=1}function a(n){typeof n=="number"&&n>=1&&n<=D.value&&(o.value=n)}function d(){o.value<D.value&&o.value++}function h(){o.value>1&&o.value--}function M(n){r.currentTest=n,window.location.href=`/performance/vue-dist/results.html?testId=${n.testId}`}function L(n){x.value=n,S.value=!0}function z(){x.value=null,S.value=!1}async function q(){if(!x.value)return;w.value=!0;const n=x.value.testId;try{await ee.deleteTest(n),console.log(`테스트 삭제 성공: ${n}`),await U(),S.value=!1,x.value=null}catch(s){console.error("테스트 삭제 실패:",s),alert("테스트 삭제 중 오류가 발생했습니다.")}finally{w.value=!1}}function G(n){return n?new Date(n).toLocaleString():"-"}function oe(n){if(!n)return"-";const s=Math.floor(n/60),y=n%60;return s>0?`${s}m ${y}s`:`${y}s`}function ae(n){switch(n){case"RUNNING":return"status-running";case"COMPLETED":return"status-completed";case"FAILED":case"ERROR":return"status-failed";case"STOPPED":return"status-stopped";default:return"status-unknown"}}function ne(n){r.currentTest=n,console.log("Selected test:",n)}return(n,s)=>{var y,f;return b(),m(E,null,[e("div",null,[e("div",he,[s[5]||(s[5]=e("h2",{class:"text-lg font-bold"},"Test History",-1)),e("button",{onClick:U,disabled:u.value,class:"flat-btn flat-btn-secondary text-sm disabled:opacity-50"},c(u.value?"Loading...":"Refresh"),9,$e)]),e("div",Se,[e("div",ke,[C(e("input",{"onUpdate:modelValue":s[0]||(s[0]=p=>g.value=p),type:"text",placeholder:"Search tests...",class:"flex-1 flat-input text-sm"},null,512),[[R,g.value]]),C(e("select",{"onUpdate:modelValue":s[1]||(s[1]=p=>v.value=p),class:"flat-input text-sm"},[...s[6]||(s[6]=[le('<option value="" data-v-c98ba60a>All Status</option><option value="RUNNING" data-v-c98ba60a>Running</option><option value="COMPLETED" data-v-c98ba60a>Completed</option><option value="FAILED" data-v-c98ba60a>Failed</option><option value="STOPPED" data-v-c98ba60a>Stopped</option>',5)])],512),[[X,v.value]])])]),_.value.length===0?(b(),m("div",we,c(g.value||v.value?"No tests match your filters":"No test history available"),1)):(b(),m("div",Te,[e("div",Ie,[e("table",De,[e("thead",Ce,[e("tr",null,[e("th",{class:"px-3 py-2 text-left text-sm font-semibold text-gray-700 uppercase cursor-pointer",onClick:s[2]||(s[2]=p=>t("testName"))},[s[7]||(s[7]=T(" Test Name ",-1)),l.value==="testName"?(b(),m("span",Ne,c(i.value==="asc"?"↑":"↓"),1)):P("",!0)]),e("th",{class:"px-3 py-2 text-left text-sm font-semibold text-gray-700 uppercase cursor-pointer",onClick:s[3]||(s[3]=p=>t("startTime"))},[s[8]||(s[8]=T(" Start Time ",-1)),l.value==="startTime"?(b(),m("span",Pe,c(i.value==="asc"?"↑":"↓"),1)):P("",!0)]),e("th",{class:"px-3 py-2 text-left text-sm font-semibold text-gray-700 uppercase cursor-pointer",onClick:s[4]||(s[4]=p=>t("status"))},[s[9]||(s[9]=T(" Status ",-1)),l.value==="status"?(b(),m("span",Me,c(i.value==="asc"?"↑":"↓"),1)):P("",!0)]),s[10]||(s[10]=e("th",{class:"px-3 py-2 text-left text-sm font-semibold text-gray-700 uppercase"},"Metrics",-1)),s[11]||(s[11]=e("th",{class:"px-3 py-2 text-left text-sm font-semibold text-gray-700 uppercase"},"Actions",-1))])]),e("tbody",Ue,[(b(!0),m(E,null,B(O.value,p=>(b(),m("tr",{key:p.testId,class:"border-b border-gray-100 hover:bg-gray-50/50 transition-colors cursor-pointer",onClick:J=>ne(p)},[e("td",Ee,[e("div",null,[e("div",Ae,c(p.testName||`Test #${p.testId}`),1),e("div",Fe,"ID: "+c(p.testId),1)])]),e("td",Ve,[e("div",je,c(G(p.startTime)),1),e("div",Le,c(oe(p.testDurationSeconds)),1)]),e("td",ze,[e("span",{class:A([ae(p.status),"status-badge"])},c(p.status),3)]),e("td",qe,[e("div",He,[s[12]||(s[12]=e("span",{class:"font-semibold"},"Users:",-1)),T(" "+c(p.maxConcurrentUsers||"N/A"),1)]),e("div",Be,[s[13]||(s[13]=e("span",{class:"font-semibold"},"Type:",-1)),T(" "+c(p.runType||"TEST"),1)]),p.avgTps?(b(),m("div",We,[s[14]||(s[14]=e("span",{class:"font-semibold"},"TPS:",-1)),T(" "+c(p.avgTps.toFixed(2)),1)])):P("",!0)]),e("td",Oe,[e("button",{onClick:Y(J=>M(p),["stop"]),class:"text-blue-600 hover:text-blue-900 text-sm font-semibold"}," Details ",8,Qe),e("button",{onClick:Y(J=>L(p),["stop"]),class:"text-red-600 hover:text-red-900 text-sm font-semibold ml-2"}," Delete ",8,Ge)])],8,Re))),128))])])]),e("div",Je,[e("div",Ke,[e("button",{onClick:h,disabled:o.value===1,class:"relative inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,Xe),e("button",{onClick:d,disabled:o.value===D.value,class:"ml-3 relative inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"}," Next ",8,Ye)]),e("div",Ze,[e("div",null,[e("p",et,[s[15]||(s[15]=T(" Showing ",-1)),e("span",tt,c((o.value-1)*I.value+1),1),s[16]||(s[16]=T(" to ",-1)),e("span",st,c(Math.min(o.value*I.value,_.value.length)),1),s[17]||(s[17]=T(" of ",-1)),e("span",ot,c(_.value.length),1),s[18]||(s[18]=T(" results ",-1))])]),e("div",null,[e("nav",at,[e("button",{onClick:h,disabled:o.value===1,class:"relative inline-flex items-center px-2 py-1 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,nt),(b(!0),m(E,null,B(Q.value,p=>(b(),m("button",{key:p,onClick:J=>a(p),class:A([{"bg-blue-50 border-blue-500 text-blue-600":p===o.value,"bg-white border-gray-300 text-gray-500 hover:bg-gray-50":p!==o.value},"relative inline-flex items-center px-3 py-1 border text-sm font-medium"])},c(p),11,rt))),128)),e("button",{onClick:d,disabled:o.value===D.value,class:"relative inline-flex items-center px-2 py-1 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"}," Next ",8,lt)])])])])]))]),S.value?(b(),m("div",it,[e("div",dt,[s[21]||(s[21]=e("h3",{class:"text-lg font-bold text-gray-900 mb-4"},"테스트 삭제 확인",-1)),e("div",ct,[s[19]||(s[19]=e("p",{class:"text-sm text-gray-600 mb-2"},"다음 테스트를 삭제하시겠습니까?",-1)),e("div",ut,[e("p",pt,c(((y=x.value)==null?void 0:y.testName)||"Unknown Test"),1),e("p",vt,"ID: "+c((f=x.value)==null?void 0:f.testId),1)])]),s[22]||(s[22]=e("div",{class:"bg-yellow-50 border border-yellow-200 p-3 mb-4"},[e("p",{class:"text-sm text-yellow-800"},[e("i",{class:"fas fa-exclamation-triangle mr-2"}),T(" 이 작업은 되돌릴 수 없습니다. 데이터베이스, Redis, 리포트 파일이 모두 삭제됩니다. ")])],-1)),e("div",mt,[e("button",{onClick:z,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 hover:bg-gray-200"}," 취소 "),e("button",{onClick:q,disabled:w.value,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-red-700 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed"},[w.value?(b(),m("span",gt,[...s[20]||(s[20]=[e("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),T("삭제 중... ",-1)])])):(b(),m("span",ft,"삭제"))],8,bt)])])])):P("",!0)],64)}}},yt=F(xt,[["__scopeId","data-v-c98ba60a"]]),_t={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2"},ht={class:"metric-card"},$t={class:"flex items-center"},St={class:"ml-3"},kt={class:"card-metric"},wt={class:"metric-card"},Tt={class:"flex items-center"},It={class:"ml-3"},Dt={class:"card-metric"},Ct={class:"metric-card"},Nt={class:"flex items-center"},Pt={class:"ml-3"},Mt={class:"card-metric"},Ut={class:"metric-card"},Rt={class:"flex items-center"},Et={class:"ml-3"},At={class:"card-metric"},Ft={class:"metric-card"},Vt={class:"flex items-center"},jt={class:"ml-3"},Lt={class:"card-metric"},zt={__name:"QuickStats",setup(j){const r=V();function u(v){return v?v.toFixed(2):"0"}function g(v){return v?(v*100).toFixed(1):"0"}return(v,l)=>(b(),m("div",_t,[e("div",ht,[e("div",$t,[l[1]||(l[1]=e("div",{class:"icon-box border-l-4 border-blue-500"},[e("svg",{class:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])],-1)),e("div",St,[l[0]||(l[0]=e("p",{class:"card-label uppercase"},"Today Tests",-1)),e("p",kt,c($(r).quickStats.todayTests),1)])])]),e("div",wt,[e("div",Tt,[l[3]||(l[3]=e("div",{class:"icon-box border-l-4 border-green-500"},[e("svg",{class:"w-6 h-6 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",It,[l[2]||(l[2]=e("p",{class:"card-label uppercase"},"Success Rate",-1)),e("p",Dt,c(g($(r).quickStats.avgSuccessRate))+"%",1)])])]),e("div",Ct,[e("div",Nt,[l[5]||(l[5]=e("div",{class:"icon-box border-l-4 border-purple-500"},[e("svg",{class:"w-6 h-6 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1)),e("div",Pt,[l[4]||(l[4]=e("p",{class:"card-label uppercase"},"Avg TPS",-1)),e("p",Mt,c(u($(r).quickStats.avgTps)),1)])])]),e("div",Ut,[e("div",Rt,[l[7]||(l[7]=e("div",{class:"icon-box border-l-4 border-yellow-500"},[e("svg",{class:"w-6 h-6 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",Et,[l[6]||(l[6]=e("p",{class:"card-label uppercase"},"Avg Response",-1)),e("p",At,c(u($(r).quickStats.avgResponseTime))+"ms",1)])])]),e("div",Ft,[e("div",Vt,[l[9]||(l[9]=e("div",{class:"icon-box border-l-4 border-red-500"},[e("div",{class:"w-3 h-3 bg-red-500 animate-pulse"})],-1)),e("div",jt,[l[8]||(l[8]=e("p",{class:"card-label uppercase"},"Active Tests",-1)),e("p",Lt,c($(r).quickStats.activeTestsCount),1)])])])]))}},qt=F(zt,[["__scopeId","data-v-5a47c9f8"]]),Ht={class:"flat-header flex justify-between items-center"},Bt={class:"card-label"},Wt={key:0,class:"text-gray-500 text-center py-8"},Ot={key:1,class:"space-y-2"},Qt={class:"flex justify-between items-start mb-2"},Gt={class:"card-subtitle"},Jt={class:"card-label"},Kt={class:"flex space-x-2"},Xt=["onClick"],Yt=["onClick","disabled"],Zt={class:"mb-2"},es={class:"flex justify-between text-sm text-gray-600 mb-1"},ts={class:"progress-bar"},ss={class:"grid grid-cols-4 gap-2"},os={class:"text-center"},as={class:"card-value"},ns={class:"text-center"},rs={class:"card-value"},ls={class:"text-center"},is={class:"card-value"},ds={class:"text-center"},cs={class:"mt-2 pt-2 border-t border-gray-200"},us={class:"flex justify-between"},ps={class:"card-label"},vs={class:"card-label"},ms={__name:"ActiveTests",setup(j){const r=V(),u=te(),g=k([]),v=N(()=>r.activeTests),l=k({});ie(()=>{l.value={...r.testMetrics}});function i(t,a=0){if(r.hasMetricsSubscription(t)){console.log(`Already subscribed to metrics for test ${t}`);return}if(console.log(`Attempting to subscribe to test ${t}, WebSocket connected: ${u.connected.value}, retry: ${a}`),!u.connected.value){a<10?(console.log(`WebSocket not connected, retrying in 1 second (attempt ${a+1}/10)`),setTimeout(()=>i(t,a+1),1e3)):console.error(`Failed to subscribe to test ${t} after 10 retries`);return}const d=u.subscribe(`/topic/metrics/${t}`,h=>{r.updateTestMetrics(t,h)});d?(r.registerMetricsSubscription(t,d),console.log(`Successfully subscribed to metrics for test ${t}`)):console.error(`Failed to create subscription for test ${t}`)}function o(t){r.unregisterMetricsSubscription(t),r.clearTestMetrics(t)}W(()=>{console.log("ActiveTests component mounted"),console.log("Initial activeTests:",v.value),K(v,(t,a)=>{console.log("ActiveTests changed:",{newTests:(t==null?void 0:t.length)||0,oldTests:(a==null?void 0:a.length)||0,wsConnected:u.connected.value,newTestsList:(t==null?void 0:t.map(d=>({id:d.testId,status:d.status})))||[],oldTestsList:(a==null?void 0:a.map(d=>({id:d.testId,status:d.status})))||[]}),t.forEach(d=>{a!=null&&a.find(h=>h.testId===d.testId)||(console.log("New test found, subscribing:",d.testId),i(d.testId))}),a==null||a.forEach(d=>{t.find(h=>h.testId===d.testId)||(console.log("Test removed, unsubscribing:",d.testId),o(d.testId))})},{immediate:!0,deep:!0}),K(()=>r.tests,t=>{console.log("Store tests changed:",{totalTests:(t==null?void 0:t.length)||0,runningTests:(t==null?void 0:t.filter(a=>a.status==="RUNNING").length)||0,runningTestIds:(t==null?void 0:t.filter(a=>a.status==="RUNNING").map(a=>a.testId))||[]}),de(()=>{console.log("After nextTick - activeTests count:",v.value.length)})},{immediate:!0,deep:!0}),K(()=>u.connected.value,t=>{console.log("WebSocket connection status changed:",t),t&&(console.log("WebSocket connected, subscribing to all active tests:",v.value.map(a=>a.testId)),v.value.forEach(a=>{setTimeout(()=>{i(a.testId)},500)}))},{immediate:!0})}),Z(()=>{v.value.forEach(t=>{o(t.testId)})});function I(t){if(!t.startTime||!t.testDurationSeconds)return 0;const a=(Date.now()-new Date(t.startTime))/1e3,d=Math.min(a/t.testDurationSeconds*100,100);return Math.round(d)}function S(t){if(!t)return"0:00";const a=Math.floor((Date.now()-new Date(t).getTime())/1e3);if(a<0)return"0:00";const d=Math.floor(a/60),h=a%60;return`${d}:${h.toString().padStart(2,"0")}`}function x(t){if(!t.startTime||!t.testDurationSeconds)return"Unknown";const a=(Date.now()-new Date(t.startTime))/1e3,d=Math.max(t.testDurationSeconds-a,0),h=Math.floor(d/60),M=Math.floor(d%60);return d<=0?"Completing...":`${h}:${M.toString().padStart(2,"0")}`}async function w(t){if(!g.value.includes(t.testId)){g.value.push(t.testId);try{await r.stopTest(t.testId),o(t.testId)}catch(a){console.error("Failed to stop test:",a)}finally{const a=g.value.indexOf(t.testId);a!==-1&&g.value.splice(a,1)}}}function _(t){const a=`/performance/vue-dist/monitor.html?testId=${t.testId}`;window.open(a,"_blank")}function D(t){return t?t.toFixed(2):"0"}function O(t){return t?(t*100).toFixed(1):"0"}function Q(t){return t?new Date(t).toLocaleTimeString():"-"}function U(t){return t>.1?"text-red-600":t>.05?"text-orange-600":"text-green-600"}return(t,a)=>(b(),m("div",null,[e("div",Ht,[a[0]||(a[0]=e("h2",{class:"card-title"},"Active Tests",-1)),e("span",Bt,c(v.value.length)+" running",1)]),v.value.length===0?(b(),m("div",Wt," No active tests ")):(b(),m("div",Ot,[(b(!0),m(E,null,B(v.value,d=>{var h,M,L,z,q;return b(),m("div",{key:d.testId,class:"test-card"},[e("div",Qt,[e("div",null,[e("h3",Gt,c(d.testName||`Test #${d.testId}`),1),e("p",Jt," Started: "+c(Q(d.startTime)),1)]),e("div",Kt,[e("button",{onClick:G=>_(d),class:"flat-btn-sm flat-btn-info"}," Monitor ",8,Xt),e("button",{onClick:G=>w(d),class:"flat-btn-sm flat-btn-danger",disabled:g.value.includes(d.testId)},c(g.value.includes(d.testId)?"Stopping...":"Stop"),9,Yt)])]),e("div",Zt,[e("div",es,[a[1]||(a[1]=e("span",null,"Progress",-1)),e("span",null,c(I(d))+"%",1)]),e("div",ts,[e("div",{class:"progress-fill",style:ce({width:`${I(d)}%`})},null,4)])]),e("div",ss,[e("div",os,[a[2]||(a[2]=e("p",{class:"card-label"},"TPS",-1)),e("p",as,c(D(((h=l.value[d.testId])==null?void 0:h.tps)||0)),1)]),e("div",ns,[a[3]||(a[3]=e("p",{class:"card-label"},"Users",-1)),e("p",rs,c(((M=l.value[d.testId])==null?void 0:M.activeUsers)||0)+"/"+c(d.maxUsers),1)]),e("div",ls,[a[4]||(a[4]=e("p",{class:"card-label"},"Response",-1)),e("p",is,c(D(((L=l.value[d.testId])==null?void 0:L.avgResponseTime)||0))+"ms",1)]),e("div",ds,[a[5]||(a[5]=e("p",{class:"card-label"},"Error %",-1)),e("p",{class:A(["card-value",U(((z=l.value[d.testId])==null?void 0:z.errorRate)||0)])},c(O(((q=l.value[d.testId])==null?void 0:q.errorRate)||0))+"% ",3)])]),e("div",cs,[e("div",us,[e("span",ps,"Elapsed: "+c(S(d.startTime)),1),e("span",vs,"Remaining: "+c(x(d)),1)])])])}),128))]))]))}},bs=F(ms,[["__scopeId","data-v-4f8f1156"]]),fs={class:"min-h-screen bg-gray-50"},gs={class:"bg-white border-b border-gray-300"},xs={class:"max-w-full px-4"},ys={class:"flex justify-between items-center h-12"},_s={class:"flex items-center gap-4"},hs={class:"flex items-center gap-2"},$s={class:"flex items-center gap-2"},Ss={class:"px-4 py-3"},ks={class:"mb-3"},ws={class:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3"},Ts={class:"flat-card"},Is={class:"flat-card"},Ds={class:"flat-card"},Cs={__name:"App",setup(j){const r=V(),u=te(),g=k("checking"),v=N(()=>u.connecting.value?"connecting":u.connected.value?"connected":u.error.value?"error":"disconnected"),l=N(()=>({"status-active":g.value==="connected","status-inactive":g.value==="disconnected","status-error":g.value==="error"})),i=N(()=>({"status-active":v.value==="connected","status-inactive":v.value==="disconnected"||v.value==="connecting","status-error":v.value==="error"}));async function o(){try{await ee.checkDatabaseHealth(),g.value="connected"}catch(S){g.value="error",console.error("Database health check failed:",S)}}const I=async(S=20,x=200)=>{for(let w=0;w<S;w++){if(u.connected.value)return console.log("WebSocket connected successfully"),!0;await new Promise(_=>setTimeout(_,x))}return console.warn("WebSocket connection timeout"),!1};return W(async()=>{var w;u.connect("/ws");const S=Promise.all([r.loadPlans(),r.loadTests(),r.loadTestHistory(),r.loadQuickStats(),o()]),x=await I();await S,x?(r.isTestRunning&&((w=r.currentTest)!=null&&w.id)&&u.subscribe(`/topic/metrics/${r.currentTest.id}`,_=>{console.log("Received metrics:",_)}),u.subscribe("/topic/test-started",async _=>{console.log("Test started event received:",_),console.log("Store state before loadTests:",r.debugStoreState()),await r.loadTests(),console.log("Store state after loadTests:",r.debugStoreState()),r.loadQuickStats()}),u.subscribe("/topic/test-completed",_=>{console.log("Test completed:",_),r.loadQuickStats(),r.loadTestHistory(),r.loadTests()})):console.error("WebSocket connection failed, real-time features will be disabled"),setInterval(()=>{r.loadQuickStats()},6e4)}),Z(()=>{u.disconnect()}),(S,x)=>(b(),m("div",fs,[e("header",gs,[e("div",xs,[e("div",ys,[x[2]||(x[2]=e("h1",{class:"text-xl font-bold text-gray-900"},"Performance Dashboard",-1)),e("div",_s,[e("div",hs,[x[0]||(x[0]=e("span",{class:"text-sm font-medium text-gray-600"},"WebSocket",-1)),e("span",{class:A(["px-2 py-0.5 text-xs font-bold uppercase",i.value])},c(v.value),3)]),e("div",$s,[x[1]||(x[1]=e("span",{class:"text-sm font-medium text-gray-600"},"Database",-1)),e("span",{class:A(["px-2 py-0.5 text-xs font-bold uppercase",l.value])},c(g.value),3)])])])])]),e("main",Ss,[e("section",ks,[H(qt)]),e("div",ws,[e("div",Ts,[H(_e)]),e("div",Is,[H(bs)])]),e("section",Ds,[H(yt)])])]))}},Ns=F(Cs,[["__scopeId","data-v-47058692"]]),se=ue(Ns),Ps=pe();se.use(Ps);se.mount("#dashboard-app");console.log("Vue Dashboard App initialized");
